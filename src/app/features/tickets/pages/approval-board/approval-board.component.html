<div class="approval-view">
  <!-- Header - Contacts Style -->
  <div class="flex flex-wrap items-center justify-between gap-4">
    <h2 class="text-xl">Approval Board</h2>
    <div class="flex w-full flex-col gap-4 sm:w-auto sm:flex-row sm:items-center sm:gap-3">
      <div class="flex gap-3">
        <div>
          <button
            type="button"
            class="btn btn-outline-primary p-2"
            [ngClass]="{ 'bg-primary text-white': displayType === 'list' }"
            (click)="setDisplayType('list')"
            title="List View"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
            </svg>
          </button>
        </div>
        <div>
          <button
            type="button"
            class="btn btn-outline-primary p-2"
            [ngClass]="{ 'bg-primary text-white': displayType === 'grid' }"
            (click)="setDisplayType('grid')"
            title="Grid View"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h7v7H3V3zM14 3h7v7h-7V3zM14 14h7v7h-7v-7zM3 14h7v7H3v-7z"></path>
            </svg>
          </button>
        </div>
      </div>

      <div class="flex gap-3">
        <div class="relative">
          <select
            class="form-select ltr:pl-3 ltr:pr-10 rtl:pl-10 rtl:pr-3"
            [(ngModel)]="processTypeFilter"
            (change)="onProcessTypeFilterChange()"
          >
            <option *ngFor="let type of processTypes" [value]="type">
              {{ type === 'all' ? 'All Processes' : (type | titlecase) }}
            </option>
          </select>
        </div>
        
        <div class="relative">
          <input
            type="text"
            placeholder="Search Tickets"
            class="peer form-input py-2 ltr:pr-11 rtl:pl-11"
            [(ngModel)]="searchText"
            (ngModelChange)="searchTickets()"
          />
          <div class="absolute top-1/2 -translate-y-1/2 peer-focus:text-primary ltr:right-[11px] rtl:left-[11px]">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="flex justify-center items-center h-64">
    <div class="animate-spin rounded-full h-32 w-32 border-b-2 border-primary"></div>
  </div>

  <!-- Content Views -->
  <div *ngIf="!loading">
    <!-- List View (Mailbox Style) -->
    <ng-container *ngIf="displayType === 'list'">
      <app-approval-list-view
        [tasks]="filteredTasks"
        [selectedTask]="selectedTask"
        (selectTask)="selectTask($event)"
        (deselectTask)="selectedTask = null"
        (approve)="handleApprove($event)"
        (reject)="handleReject($event)"
        (bulkApprove)="handleBulkApprove($event)"
        (bulkReject)="handleBulkReject($event)">
      </app-approval-list-view>
    </ng-container>

    <!-- Grid View (Side-by-Side Layout) -->
    <ng-container *ngIf="displayType === 'grid'">
      <app-approval-grid-view
        [tasks]="filteredTasks"
        [selectedTask]="selectedTask"
        (selectTask)="selectTask($event)"
        (approve)="handleApprove($event)"
        (reject)="handleReject($event)"
        (bulkApprove)="handleBulkApprove($event)"
        (bulkReject)="handleBulkReject($event)">
      </app-approval-grid-view>
    </ng-container>
  </div>

  <!-- Approval Confirmation Dialog -->
  <app-confirmation-dialog
    *ngIf="showApprovalDialog && confirmationDialogData"
    [isOpen]="showApprovalDialog"
    [data]="confirmationDialogData"
    (result)="onConfirmationResult($event)"
    (close)="closeApprovalDialog()">
  </app-confirmation-dialog>
</div>
